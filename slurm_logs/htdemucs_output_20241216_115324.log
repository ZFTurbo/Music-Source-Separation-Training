[I 2024-12-16 11:53:27,711] A new study created in RDB with name: no-name-8653c9bb-1409-4b4d-a0be-8e983ec4ae10
training using optuna
Instruments: ['drums', 'bass', 'other', 'vocals']
Metrics for training: ['sdr']. Metric for scheduler: sdr
Use augmentation for training
Dataset type: 1 Processes to use: 8 
Collecting metadata for ['../data/MUSDB18/train']

  0%|          | 0/80 [00:00<?, ?it/s]
  1%|▏         | 1/80 [00:03<04:49,  3.66s/it]
 10%|█         | 8/80 [00:03<00:24,  2.89it/s]
 30%|███       | 24/80 [00:03<00:05, 10.86it/s]
 52%|█████▎    | 42/80 [00:03<00:01, 22.30it/s]
 82%|████████▎ | 66/80 [00:04<00:00, 41.36it/s]
100%|██████████| 80/80 [00:04<00:00, 19.43it/s]
Found tracks in dataset: 80
CUDA is not available. Training on CPU will be very slow...
Patience: 2 Reduce factor: 0.8844888975003705 Batch size: 1 Grad accum steps: 1 Effective batch size: 1 Optimizer: adam
Train for: 1
Train epoch: 0 Learning rate: 0.00029720404721692164

  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/1 [00:36<?, ?it/s, loss=0, avg_loss=0]
100%|██████████| 1/1 [00:36<00:00, 36.86s/it, loss=0, avg_loss=0]
100%|██████████| 1/1 [00:41<00:00, 41.88s/it, loss=0, avg_loss=0]
[I 2024-12-16 11:59:12,816] Trial 0 finished with value: -0.15104765738533849 and parameters: {'lr': 0.00029720404721692164, 'reduce_factor': 0.8844888975003705, 'ema_momentum': 0.9672564211768994, 'q': 0.879656082943425, 'channels': 40, 'depth': 5, 't_layers': 8, 't_hidden_scale': 1.702257339399568, 't_heads': 4, 't_dropout': 0.056537428431553516}. Best is trial 0 with value: -0.15104765738533849.
Python(42536) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
Training loss: 0.000000
Total mixtures: 14
Overlap: 4 Batch size: 8
Song: /Users/kaimikkelsen/canada_compute/data/MUSDB18/validation/ANiMAL_-_Rockshow.stem Shape: (2, 300032)
Instr: drums
Metric sdr         value: 0.0235
Instr: bass
Metric sdr         value: -0.0877
Instr: other
Metric sdr         value: -0.2334
Instr: vocals
Metric sdr         value: -0.1345
Time for song: 20.01 sec
Song: /Users/kaimikkelsen/canada_compute/data/MUSDB18/validation/Actions_-_One_Minute_Smile.stem Shape: (2, 300032)
Instr: drums
Metric sdr         value: -0.0452
Instr: bass
Metric sdr         value: -0.4622
Instr: other
Metric sdr         value: -0.1309
Instr: vocals
Metric sdr         value: -0.1043
Time for song: 19.76 sec
Song: /Users/kaimikkelsen/canada_compute/data/MUSDB18/validation/Alexander_Ross_-_Goodbye_Bolero.stem Shape: (2, 300032)
Instr: drums
Metric sdr         value: -0.0528
Instr: bass
Metric sdr         value: -0.3341
Instr: other
Metric sdr         value: -0.1156
Instr: vocals
Metric sdr         value: -0.1519
Time for song: 23.89 sec
Song: /Users/kaimikkelsen/canada_compute/data/MUSDB18/validation/Clara_Berry_And_Wooldog_-_Waltz_For_My_Victims.stem Shape: (2, 300032)
Instr: drums
Metric sdr         value: -0.3169
Instr: bass
Metric sdr         value: -0.2663
Instr: other
Metric sdr         value: -0.0856
Instr: vocals
Metric sdr         value: -0.1736
Time for song: 19.65 sec
Song: /Users/kaimikkelsen/canada_compute/data/MUSDB18/validation/Fergessen_-_Nos_Palpitants.stem Shape: (2, 300032)
Instr: drums
Metric sdr         value: -0.0758
Instr: bass
Metric sdr         value: -0.8893
Instr: other
Metric sdr         value: -0.1936
Instr: vocals
Metric sdr         value: -0.1202
Time for song: 19.46 sec
Song: /Users/kaimikkelsen/canada_compute/data/MUSDB18/validation/James_May_-_On_The_Line.stem Shape: (2, 300032)
Instr: drums
Metric sdr         value: -0.0055
Instr: bass
Metric sdr         value: -0.1462
Instr: other
Metric sdr         value: -0.1614
Instr: vocals
Metric sdr         value: -0.1498
Time for song: 18.87 sec
Song: /Users/kaimikkelsen/canada_compute/data/MUSDB18/validation/Johnny_Lokke_-_Promises_&_Lies.stem Shape: (2, 300032)
Instr: drums
Metric sdr         value: 0.0288
Instr: bass
Metric sdr         value: -0.1864
Instr: other
Metric sdr         value: -0.1041
Instr: vocals
Metric sdr         value: -0.1258
Time for song: 19.16 sec
Song: /Users/kaimikkelsen/canada_compute/data/MUSDB18/validation/Leaf_-_Summerghost.stem Shape: (2, 300032)
Instr: drums
Metric sdr         value: 0.0323
Instr: bass
Metric sdr         value: -0.0597
Instr: other
Metric sdr         value: -0.3385
Instr: vocals
Metric sdr         value: -0.1598
Time for song: 26.53 sec
Song: /Users/kaimikkelsen/canada_compute/data/MUSDB18/validation/Meaxic_-_Take_A_Step.stem Shape: (2, 300032)
Instr: drums
Metric sdr         value: 0.0259
Instr: bass
Metric sdr         value: -0.1067
Instr: other
Metric sdr         value: -0.5432
Instr: vocals
Metric sdr         value: -0.1134
Time for song: 25.15 sec
Song: /Users/kaimikkelsen/canada_compute/data/MUSDB18/validation/Patrick_Talbot_-_A_Reason_To_Leave.stem Shape: (2, 300032)
Instr: drums
Metric sdr         value: 0.0102
Instr: bass
Metric sdr         value: -0.1994
Instr: other
Metric sdr         value: -0.1965
Instr: vocals
Metric sdr         value: -0.1353
Time for song: 21.09 sec
Song: /Users/kaimikkelsen/canada_compute/data/MUSDB18/validation/Skelpolu_-_Human_Mistakes.stem Shape: (2, 300032)
Instr: drums
Metric sdr         value: -0.0165
Instr: bass
Metric sdr         value: -0.0323
Instr: other
Metric sdr         value: -0.2214
Instr: vocals
Metric sdr         value: -0.2339
Time for song: 19.11 sec
Song: /Users/kaimikkelsen/canada_compute/data/MUSDB18/validation/Traffic_Experiment_-_Sirens.stem Shape: (2, 300032)
Instr: drums
Metric sdr         value: 0.0499
Instr: bass
Metric sdr         value: -0.2175
Instr: other
Metric sdr         value: -0.0768
Instr: vocals
Metric sdr         value: -0.1078
Time for song: 19.96 sec
Song: /Users/kaimikkelsen/canada_compute/data/MUSDB18/validation/Triviul_-_Angelsaint.stem Shape: (2, 300032)
Instr: drums
Metric sdr         value: -0.1393
Instr: bass
Metric sdr         value: -0.1657
Instr: other
Metric sdr         value: -0.1180
Instr: vocals
Metric sdr         value: -0.1225
Time for song: 21.17 sec
Song: /Users/kaimikkelsen/canada_compute/data/MUSDB18/validation/Young_Griffo_-_Pennies.stem Shape: (2, 300032)
Instr: drums
Metric sdr         value: -0.0282
Instr: bass
Metric sdr         value: -0.0727
Instr: other
Metric sdr         value: -0.2130
Instr: vocals
Metric sdr         value: -0.1581
Time for song: 18.75 sec
Num overlap: 4
Instr drums sdr: -0.0364 (Std: 0.0921)
Instr bass sdr: -0.2304 (Std: 0.2143)
Instr other sdr: -0.1951 (Std: 0.1183)
Instr vocals sdr: -0.1422 (Std: 0.0325)
Metric avg sdr        : -0.1510
Elapsed time: 292.59 sec
Store weights: checkpoints/mac_20241216_115324/model_htdemucs_ep_0_sdr_-0.1510.ckpt
Instruments: ['drums', 'bass', 'other', 'vocals']
Metrics for training: ['sdr']. Metric for scheduler: sdr
Use augmentation for training
Dataset type: 1 Processes to use: 8 
Collecting metadata for ['../data/MUSDB18/train']
Found metadata cache file: checkpoints/mac_20241216_115324/metadata_1.pkl
Old metadata was used for 80 tracks.
Python(42537) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
Python(42538) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
Python(42539) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
Python(42540) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
Python(42541) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
Python(42542) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
Python(42543) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
Python(42544) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.

0it [00:00, ?it/s]
0it [00:00, ?it/s]
Found tracks in dataset: 80
CUDA is not available. Training on CPU will be very slow...
Patience: 2 Reduce factor: 0.930139659999955 Batch size: 1 Grad accum steps: 1 Effective batch size: 1 Optimizer: adam
Train for: 1
Train epoch: 0 Learning rate: 2.8812141121963122e-05

  0%|          | 0/1 [00:00<?, ?it/s]Python(42545) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
Python(42546) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
Python(42547) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
Python(42548) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
Python(42549) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
Python(42550) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
Python(42552) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.
Python(42554) MallocStackLogging: can't turn off malloc stack logging because it was not enabled.

  0%|          | 0/1 [00:30<?, ?it/s, loss=0, avg_loss=0]
100%|██████████| 1/1 [00:30<00:00, 30.36s/it, loss=0, avg_loss=0]
100%|██████████| 1/1 [00:35<00:00, 35.36s/it, loss=0, avg_loss=0]
